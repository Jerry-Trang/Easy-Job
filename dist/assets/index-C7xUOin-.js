import{J as e,O as U,r as o,V as _,M as z,a1 as x,a7 as G,a8 as Q,X}from"./index-DHzXfQ7z.js";import{a as q,u as W,F as i,o as Z,d as M,J as ee}from"./validation-zzlJTz6b.js";import{a as d,I as se}from"./ImageUpload-CLncqo9P.js";import{L as n}from"./Label-DA88bp2o.js";import{B as re}from"./Button-BhPHHdR9.js";import{D as f,a as D,b as v,c as b}from"./DropdownOption-CM12wnLo.js";import{u as ae}from"./useAddress-CXmfzuKZ.js";import{u as ne,U as te}from"./role.enum-D755UW9F.js";import ie from"./index-CbJxLnyD.js";import{u as oe,L as le}from"./loadingData-gGmBOXe5.js";import"./PurePanel-Beii1x7H.js";import"./Overflow-DU_nsBdJ.js";import"./index-NUNVQHGT.js";import"./useIcons-D9dmKqoX.js";import"./SearchOutlined-D0zVLWoL.js";import"./button-QyKJ-Hjt.js";function ce({name:t="",placeholder:j,content:c,control:u,className:h}){const{field:m}=q({control:u,name:t,defaultValue:""});return e.jsx("div",{className:"relative w-full",children:e.jsx("textarea",{id:t,...m,className:`w-full py-4 px-5 rounded-lg font-medium transition-all border border-solid border-[#DFDFDF] resize-none min-h-[200px] focus:outline-none focus:ring-1 focus:ring-[#3F8CFF] ${h}`,placeholder:j,value:m.value,children:c})})}function Fe(){const{control:t,handleSubmit:j,setValue:c,reset:u,formState:{errors:h}}=W({mode:"onChange",resolver:Z(ee),defaultValues:{title:"",phone:"",address:"",startDate:"",endDate:"",duration:0,districtId:0,provinceId:0,jobTypeId:0,description:"",imageJobDetails:void 0}}),{role:m}=ne(),T=U(X),E=m===te.ROLE_EMPLOYER,L=oe(),[g,y]=o.useState(!1),{provinces:w,districts:A,setProvinceAndFetchDistricts:C}=ae(),{objJobType:S}=_(s=>s.typeReducer),N=z(),[a,R]=o.useState(),[Y,k]=o.useState(),[p,F]=o.useState(),$=async s=>{R(s),c("jobTypeId",~~s.id)},J=s=>{k(s),c("provinceId",~~s.id),F(void 0),C(s.id)},O=s=>{F(s),c("districtId",~~s.id)},H=async()=>{const s=Q();N(s)};o.useEffect(()=>{H()},[]);const[V,P]=o.useState([!1,!1,!1,!1]),B=s=>{P(r=>{const l=[...r];return l[s]=!0,l})},K=async s=>{try{const r={...s,startDate:s.startDate?M(s.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null,endDate:s.endDate?M(s.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null};if(await N(G(r)),V.some(l=>l)){x.error("Vui lòng tải lại ảnh!");return}x.success("Đã đăng bài thành công!"),u(),y(!0)}catch(r){x.error("Đăng bài thất bại!"),console.error("Add error:",r)}};return o.useEffect(()=>{g&&y(!1)},[g]),o.useEffect(()=>{var r;const s=Object.values(h);s.length>0&&x.error((r=s[0])==null?void 0:r.message)},[h]),!E||!T?e.jsx(ie,{}):e.jsx("div",{className:"py-20 px-[72px]",children:e.jsxs("div",{className:"bg-white py-4 shadow-md px-11 rounded-xl",children:[e.jsx("div",{className:"mb-5 py-10",children:e.jsx("div",{children:e.jsx("h1",{className:"text-[40px] font-semibold capitalize",children:"Đăng bài ứng tuyển"})})}),e.jsxs("form",{onSubmit:j(K),children:[e.jsx("div",{className:"mb-5 lg:mb-10",children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"title",children:"Tiêu đề ứng tuyển"}),e.jsx(d,{name:"title",placeholder:"Nhập tiêu đề",control:t})]})}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"startDate",children:"Ngày bắt đầu"}),e.jsx(d,{type:"date",dateFormat:"YYYY-MM-DD",name:"startDate",placeholder:"YYYY-MM-DD",control:t})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"endDate",children:"Ngày kết thúc ứng tuyển"}),e.jsx(d,{type:"date",dateFormat:"YYYY-MM-DD",name:"endDate",placeholder:"YYYY-MM-DD",control:t})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"duration",children:"Khoảng thời gian (Đơn vị tính: phút)"}),e.jsx(d,{type:"number",name:"duration",min:0,placeholder:"Nhập khoảng thời gian",control:t})]})})]}),e.jsxs("div",{className:"form-layout",children:[e.jsxs(i,{children:[e.jsx(n,{htmlFor:"phone",children:"Số điện thoại"}),e.jsx(d,{type:"tel",name:"phone",placeholder:"Nhập số điện thoại",control:t})]}),e.jsxs(i,{children:[e.jsx(n,{children:"Loại công việc"}),e.jsxs(f,{children:[e.jsx(D,{value:`${(a==null?void 0:a.name)||"Loại công việc - Mức phí dịch vụ"} ${a!=null&&a.minPrice&&(a!=null&&a.maxPrice)?` (${a.minPrice} - ${a.maxPrice}) / Giờ`:""}`}),e.jsx(v,{children:(Array.isArray(S)?S:[]).map(s=>e.jsx(b,{name:"jobTypeId",onClick:()=>$(s),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{children:s.name}),e.jsxs("div",{className:"text-gray-400",children:["( ",s.minPrice," - ",s.maxPrice," ) / Giờ"]})]})},s.id))})]})]})]}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"address",children:"Địa chỉ"}),e.jsx(d,{name:"address",placeholder:"Nhập địa chỉ, tên đường",control:t})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(i,{children:[e.jsx(n,{children:"Tỉnh / Thành phố"}),e.jsxs(f,{children:[e.jsx(D,{value:Y?Y.name:"Tỉnh / Thành phố"}),e.jsx(v,{children:w.map(s=>e.jsx(b,{name:"provinceId",onClick:()=>J(s),children:s.name},s.id))})]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(i,{children:[e.jsx(n,{children:"Quận / Huyện"}),e.jsxs(f,{children:[e.jsx(D,{value:p?p==null?void 0:p.name:"Quận / Huyện"}),e.jsx(v,{children:A.map(s=>e.jsx(b,{name:"districtId",onClick:()=>O(s),children:s.name},s.id))})]})]})})]}),e.jsxs("div",{className:"mt-24",children:[e.jsx(n,{htmlFor:"",children:"Tải ảnh về công việc và nơi làm việc"}),e.jsx("div",{className:"border border-solid border-[#D5D5D5] rounded-3xl p-4 mt-10 mb-20",children:e.jsx("div",{className:"grid grid-cols-2 gap-6",children:Array.from({length:4},(s,r)=>e.jsx(se,{name:`imageJobDetails${r+1}`,onFileSelect:l=>{l?(c(`imageJobDetails.${r+1}`,{file:l}),P(I=>(I[r]=!1,I))):console.error("Không có tệp nào được chọn")},resetTrigger:g,onRemove:()=>B(r)},`imageJobDetails${r+1}`))})})]}),e.jsx("div",{children:e.jsxs(i,{children:[e.jsx(n,{htmlFor:"description",children:"Mô tả"}),e.jsx(ce,{name:"description",control:t,placeholder:"Mô tả ..."})]})}),e.jsx(re,{type:"submit",title:"Đăng Bài",className:"w-full mt-10 h-16"}),L&&e.jsx("div",{className:"mt-3 text-center",children:e.jsx(le,{})})]})]})})}export{Fe as default};
