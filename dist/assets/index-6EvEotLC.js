import{J as e,O as K,r as o,V as U,M as z,_ as p,a8 as Q,a9 as X,X as q}from"./index-pFVdx9L3.js";import{u as G,a as W,F as n,b as c,I as Z,o as ee,d as M,J as se}from"./validation-Brh-Tjro.js";import{L as r,D as f,a as D,b as v,c as b}from"./DropdownOption-Bb4Tivt6.js";import{B as te}from"./Button-j4AAYWSM.js";import{u as re}from"./useAddress-kTC2VjRJ.js";import{u as ae,U as ne}from"./role.enum-3anQw8ih.js";import oe from"./index-Ddt2kwPD.js";import{u as ie,L as le}from"./loadingData-DZnKJ9bS.js";import"./PurePanel-CJciXoPf.js";import"./Overflow-B3BILk7e.js";import"./index-CNQ_-D8b.js";import"./useIcons-CBnoQWkn.js";import"./SearchOutlined-BcT8nnCA.js";import"./button-CyzeZ6Lg.js";function ce({name:a="",placeholder:x,content:l,control:u,className:d}){const{field:h}=G({control:u,name:a,defaultValue:""});return e.jsx("div",{className:"relative w-full",children:e.jsx("textarea",{id:a,...h,className:`w-full py-4 px-5 rounded-lg font-medium transition-all border border-solid border-[#DFDFDF] resize-none min-h-[200px] focus:outline-none focus:ring-1 focus:ring-[#3F8CFF] ${d}`,placeholder:x,value:h.value,children:l})})}function Ne(){const{control:a,handleSubmit:x,setValue:l,reset:u,formState:{errors:d}}=W({mode:"onChange",resolver:ee(se),defaultValues:{title:"",phone:"",address:"",startDate:"",endDate:"",duration:0,districtId:0,provinceId:0,jobTypeId:0,description:"",imageJobDetails:void 0}}),{role:h}=ae(),E=K(q),L=h===ne.ROLE_EMPLOYER,P=ie(),[j,y]=o.useState(!1),{provinces:w,districts:A,setProvinceAndFetchDistricts:J}=re(),{objJobType:S}=U(s=>s.typeReducer),N=z(),[g,C]=o.useState(),[Y,R]=o.useState(),[m,F]=o.useState(),k=async s=>{C(s),l("jobTypeId",~~s.id)},O=s=>{R(s),l("provinceId",~~s.id),F(void 0),J(s.id)},H=s=>{F(s),l("districtId",~~s.id)},V=async()=>{const s=X();N(s)};o.useEffect(()=>{V()},[]);const[$,T]=o.useState([!1,!1,!1,!1]),B=s=>{T(t=>{const i=[...t];return i[s]=!0,i})},_=async s=>{try{const t={...s,startDate:s.startDate?M(s.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null,endDate:s.endDate?M(s.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null};if(await N(Q(t)),$.some(i=>i)){p.error("Vui lòng tải lại ảnh!");return}p.success("Đã đăng bài thành công!"),u(),y(!0)}catch(t){p.error("Đăng bài thất bại!"),console.error("Add error:",t)}};return o.useEffect(()=>{j&&y(!1)},[j]),o.useEffect(()=>{var t;const s=Object.values(d);s.length>0&&p.error((t=s[0])==null?void 0:t.message)},[d]),!L||!E?e.jsx(oe,{}):e.jsx("div",{className:"py-20 px-[72px]",children:e.jsxs("div",{className:"bg-white py-4 shadow-md px-11 rounded-xl",children:[e.jsx("div",{className:"mb-5 py-10",children:e.jsx("div",{children:e.jsx("h1",{className:"text-[40px] font-semibold capitalize",children:"Đăng bài ứng tuyển"})})}),e.jsxs("form",{onSubmit:x(_),children:[e.jsx("div",{className:"mb-5 lg:mb-10",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"title",children:"Tiêu đề ứng tuyển"}),e.jsx(c,{name:"title",placeholder:"Nhập tiêu đề",control:a})]})}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"startDate",children:"Ngày bắt đầu"}),e.jsx(c,{type:"date",dateFormat:"YYYY-MM-DD",name:"startDate",placeholder:"YYYY-MM-DD",control:a})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"endDate",children:"Ngày kết thúc ứng tuyển"}),e.jsx(c,{type:"date",dateFormat:"YYYY-MM-DD",name:"endDate",placeholder:"YYYY-MM-DD",control:a})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"duration",children:"Khoảng thời gian (Đơn vị tính: phút)"}),e.jsx(c,{type:"number",name:"duration",min:0,placeholder:"Nhập khoảng thời gian",control:a})]})})]}),e.jsxs("div",{className:"form-layout",children:[e.jsxs(n,{children:[e.jsx(r,{htmlFor:"phone",children:"Số điện thoại"}),e.jsx(c,{type:"tel",name:"phone",placeholder:"Nhập số điện thoại",control:a})]}),e.jsxs(n,{children:[e.jsx(r,{children:"Loại công việc"}),e.jsxs(f,{children:[e.jsx(D,{value:`${(g==null?void 0:g.name)||"Loại công việc"}`}),e.jsx(v,{children:(Array.isArray(S)?S:[]).map(s=>e.jsx(b,{name:"jobTypeId",onClick:()=>k(s),children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"address",children:"Địa chỉ"}),e.jsx(c,{name:"address",placeholder:"Nhập địa chỉ, tên đường",control:a})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{children:"Tỉnh / Thành phố"}),e.jsxs(f,{children:[e.jsx(D,{value:Y?Y.name:"Tỉnh / Thành phố"}),e.jsx(v,{children:w.map(s=>e.jsx(b,{name:"provinceId",onClick:()=>O(s),children:s.name},s.id))})]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{children:"Quận / Huyện"}),e.jsxs(f,{children:[e.jsx(D,{value:m?m==null?void 0:m.name:"Quận / Huyện"}),e.jsx(v,{children:A.map(s=>e.jsx(b,{name:"districtId",onClick:()=>H(s),children:s.name},s.id))})]})]})})]}),e.jsxs("div",{className:"mt-24",children:[e.jsx(r,{htmlFor:"",children:"Tải ảnh về công việc và nơi làm việc"}),e.jsx("div",{className:"border border-solid border-[#D5D5D5] rounded-3xl p-4 mt-10 mb-20",children:e.jsx("div",{className:"grid grid-cols-2 gap-6",children:Array.from({length:4},(s,t)=>e.jsx(Z,{name:`imageJobDetails${t+1}`,onFileSelect:i=>{i?(l(`imageJobDetails.${t+1}`,{file:i}),T(I=>(I[t]=!1,I))):console.error("Không có tệp nào được chọn")},resetTrigger:j,onRemove:()=>B(t)},`imageJobDetails${t+1}`))})})]}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"description",children:"Mô tả"}),e.jsx(ce,{name:"description",control:a,placeholder:"Mô tả ..."})]})}),e.jsx(te,{type:"submit",title:"Đăng Bài",className:"w-full mt-10 h-16"}),P&&e.jsx("div",{className:"mt-3 text-center",children:e.jsx(le,{})})]})]})})}export{Ne as default};
