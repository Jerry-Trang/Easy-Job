import{J as e,O as z,r as o,V as Q,M as X,a1 as p,a8 as q,a9 as G,X as W}from"./index-BtIFfj4n.js";import{u as Z,a as ee,d as v,F as n,b as c,I as se,o as te,J as re}from"./validation-CDAspbbo.js";import{L as r,D as b,a as S,b as y,c as Y}from"./DropdownOption-DqyNgTXI.js";import{B as ae}from"./Button-fOeklikT.js";import{u as ne}from"./useAddress-DRoVoAKZ.js";import{u as oe,U as ie}from"./role.enum-_L9jGsOV.js";import le from"./index-DBFw5UWu.js";import"./PurePanel-CET3OxEJ.js";import"./Overflow-B1bb2TCJ.js";import"./index-B0YE6muZ.js";import"./useIcons-QRrbSnbi.js";import"./SearchOutlined-Bo7-_Fww.js";import"./button-CW_KBYS_.js";function ce({name:a="",placeholder:u,content:h,control:i,className:x}){const{field:d}=Z({control:i,name:a,defaultValue:""});return e.jsx("div",{className:"relative w-full",children:e.jsx("textarea",{id:a,...d,className:`w-full py-4 px-5 rounded-lg font-medium transition-all border border-solid border-[#DFDFDF] resize-none min-h-[200px] focus:outline-none focus:ring-1 focus:ring-[#3F8CFF] ${x}`,placeholder:u,value:d.value,children:h})})}function ye(){const{control:a,handleSubmit:u,watch:h,setValue:i,reset:x,formState:{errors:d}}=ee({mode:"onChange",resolver:te(re),defaultValues:{title:"",phone:"",address:"",startDate:"",endDate:"",duration:0,districtId:0,provinceId:0,jobTypeId:0,description:"",imageJobDetails:void 0}}),{role:H}=oe(),P=z(W),A=H===ie.ROLE_EMPLOYER,[j,N]=o.useState(!1),{provinces:J,districts:C,setProvinceAndFetchDistricts:R}=ne(),{objJobType:F}=Q(s=>s.typeReducer),T=X(),[D,k]=o.useState(),[M,L]=o.useState(),[m,I]=o.useState(),O=async s=>{k(s),i("jobTypeId",~~s.id)},V=s=>{L(s),i("provinceId",~~s.id),I(void 0),R(s.id)},$=s=>{I(s),i("districtId",~~s.id)},B=async()=>{const s=G();T(s)};o.useEffect(()=>{B()},[]);const[K,E]=o.useState([!1,!1,!1,!1]),U=s=>{E(t=>{const l=[...t];return l[s]=!0,l})},f=h("startDate"),g=h("duration");o.useEffect(()=>{if(f&&g){const s=v(f).add(g,"minute").format("YYYY-MM-DDTHH:mm:ss.SSSSSS");i("endDate",s)}},[f,g,i]);const _=async s=>{try{const t={...s,startDate:s.startDate?v(s.startDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null,endDate:s.endDate?v(s.endDate).format("YYYY-MM-DDTHH:mm:ss.SSSSSS"):null};if(await T(q(t)),K.some(l=>l)){p.error("Vui lòng tải lại ảnh!");return}p.success("Đã đăng bài thành công!"),x(),N(!0)}catch(t){p.error("Đăng bài thất bại!"),console.error("Add error:",t)}};return o.useEffect(()=>{j&&N(!1)},[j]),o.useEffect(()=>{var t;const s=Object.values(d);s.length>0&&p.error((t=s[0])==null?void 0:t.message)},[d]),!A||!P?e.jsx(le,{}):e.jsx("div",{className:"py-20 px-[72px]",children:e.jsxs("div",{className:"bg-white py-4 shadow-md px-11 rounded-xl",children:[e.jsx("div",{className:"mb-5 py-10",children:e.jsx("div",{children:e.jsx("h1",{className:"text-[40px] font-semibold capitalize",children:"Đăng bài ứng tuyển"})})}),e.jsxs("form",{onSubmit:u(_),children:[e.jsx("div",{className:"mb-5 lg:mb-10",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"title",children:"Tiêu đề ứng tuyển"}),e.jsx(c,{name:"title",placeholder:"Nhập tiêu đề",control:a})]})}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"startDate",children:"Ngày bắt đầu"}),e.jsx(c,{type:"date",dateFormat:"YYYY-MM-DDTHH:mm:ss.ssssss",name:"startDate",placeholder:"YYYY-MM-DD",control:a})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"endDate",children:"Ngày kết thúc ứng tuyển"}),e.jsx(c,{type:"date",dateFormat:"YYYY-MM-DDTHH:mm:ss.ssssss",name:"endDate",placeholder:"YYYY-MM-DD",control:a,disabled:!0})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"duration",children:"Khoảng thời gian (Đơn vị tính: phút)"}),e.jsx(c,{type:"number",name:"duration",min:0,placeholder:"Nhập khoảng thời gian",control:a})]})})]}),e.jsxs("div",{className:"form-layout",children:[e.jsxs(n,{children:[e.jsx(r,{htmlFor:"phone",children:"Số điện thoại"}),e.jsx(c,{type:"tel",name:"phone",placeholder:"Nhập số điện thoại",control:a})]}),e.jsxs(n,{children:[e.jsx(r,{children:"Loại công việc"}),e.jsxs(b,{children:[e.jsx(S,{value:`${(D==null?void 0:D.name)||"Loại công việc"}`}),e.jsx(y,{children:(Array.isArray(F)?F:[]).map(s=>e.jsx(Y,{name:"jobTypeId",onClick:()=>O(s),children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"form-layout-col4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"address",children:"Địa chỉ"}),e.jsx(c,{name:"address",placeholder:"Nhập địa chỉ, tên đường",control:a})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{children:"Tỉnh / Thành phố"}),e.jsxs(b,{children:[e.jsx(S,{value:M?M.name:"Tỉnh / Thành phố"}),e.jsx(y,{children:J.map(s=>e.jsx(Y,{name:"provinceId",onClick:()=>V(s),children:s.name},s.id))})]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs(n,{children:[e.jsx(r,{children:"Quận / Huyện"}),e.jsxs(b,{children:[e.jsx(S,{value:m?m==null?void 0:m.name:"Quận / Huyện"}),e.jsx(y,{children:C.map(s=>e.jsx(Y,{name:"districtId",onClick:()=>$(s),children:s.name},s.id))})]})]})})]}),e.jsxs("div",{className:"mt-24",children:[e.jsx(r,{htmlFor:"",children:"Tải ảnh về công việc và nơi làm việc"}),e.jsx("div",{className:"border border-solid border-[#D5D5D5] rounded-3xl p-4 mt-10 mb-20",children:e.jsx("div",{className:"grid grid-cols-2 gap-6",children:Array.from({length:4},(s,t)=>e.jsx(se,{name:`imageJobDetails${t+1}`,onFileSelect:l=>{l?(i(`imageJobDetails.${t+1}`,{file:l}),E(w=>(w[t]=!1,w))):console.error("Không có tệp nào được chọn")},resetTrigger:j,onRemove:()=>U(t)},`imageJobDetails${t+1}`))})})]}),e.jsx("div",{children:e.jsxs(n,{children:[e.jsx(r,{htmlFor:"description",children:"Mô tả"}),e.jsx(ce,{name:"description",control:a,placeholder:"Mô tả ..."})]})}),e.jsx(ae,{type:"submit",title:"Đăng Bài",className:"w-full mt-10"})]})]})})}export{ye as default};
